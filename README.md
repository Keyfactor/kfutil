# Keyfactor Utility (kfutil)

`kfutil` is a go-lang CLI wrapper for Keyfactor API. It also includes other utility/helper functions around automating common Keyfactor operations.

#### Integration status: Pilot - Ready for use in test environments. Not for use in production.

## About the Keyfactor API Client

This API client allows for programmatic management of Keyfactor resources.



## Support for Keyfactor Utility (kfutil)

Keyfactor Utility (kfutil) is open source and there is **no SLA** for this tool/library/client. Keyfactor will address issues as resources become available. Keyfactor customers may request escalation by opening up a support ticket through their Keyfactor representative.

###### To report a problem or suggest a new feature, use the **[Issues](../../issues)** tab. If you want to contribute actual bug fixes or proposed enhancements, use the **[Pull requests](../../pulls)** tab.
___




## Quickstart

```bash
make install
kfutil --help
````

### Environmental Variables

All the variables listed below need to be set in your environment. The `kfutil` command will look for these variables
and use them if they are set. If they are not set, the utility will fail to connect to Keyfactor.

```bash
export KEYFACTOR_HOSTNAME=<mykeyfactorhost.mydomain.com>
export KEYFACTOR_USERNAME=<myusername> # Do not include domain
export KEYFACTOR_PASSWORD=<mypassword>
export KEYFACTOR_DOMAIN=<mykeyfactordomain>
```

## Commands

### Bulk operations

#### Bulk create cert stores

`# TODO: Not implemented`  
This will attempt to process a CSV input file of certificate stores to create. The template can be generated by
running: `kfutil generate-template --type bulk-certstore` command.

```bash
kfutil bulk create certstores --file <path to csv file>
```

#### Bulk create cert store types

`# TODO: Not implemented`
This will attempt to process a CSV input file of certificate store types to create. The template can be generated by
running: `kfutil generate-template --type bulk-certstore-types` command.

```bash
kfutil bulk create certstores --file <path to csv file>
```

### Root of Trust

#### Generate Certificate List Template

This will write the file `certs_template.csv` to the current directory.

```bash
kfutil stores generate-template-rot --type certs
```

#### Generate Certificate Store List Template

This will write the file `certs_template.csv` to the current directory.

```bash
kfutil stores generate-template-rot --type stores
```

#### Run Root of Trust Check

This will read the file `certs.csv` from the current directory or the absolute path, and generate a report of the
certificate stores that contain the specified certificates.

```bash
kfutil stores rot --stores stores.csv --certs certs.csv
```

### Development

This CLI developed using [cobra](https://umarcor.github.io/cobra/)

#### Adding a new command

```bash
cobra-cli add <my-new-command>
```

alternatively you can specify the parent command

```bash
cobra-cli add <my-new-command> -p '<parent>Cmd'
```

